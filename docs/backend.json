{
  "entities": {
    "Product": {
      "title": "Product",
      "type": "object",
      "description": "Represents a product discovered and processed by the system.",
      "properties": {
        "source_domain": { "type": "string" },
        "source_url": { "type": "string", "format": "uri" },
        "source_product_id": { "type": "string" },
        "title": { "type": "string" },
        "normalized_title": { "type": "string" },
        "description": { "type": "string" },
        "price": { "type": "number" },
        "currency": { "type": "string" },
        "images": { "type": "array", "items": { "type": "string", "format": "uri" } },
        "image_hashes": { "type": "array", "items": { "type": "string" } },
        "seller": { "type": "object", "properties": { "name": { "type": "string" }, "rating": { "type": "number" } } },
        "reviews_count": { "type": "number" },
        "trust_score": { "type": "number" },
        "trend_score": { "type": "number" },
        "listing_status": { "type": "string", "enum": ["draft", "enriched", "approved", "published", "rejected", "removed"] },
        "provenance_raw_key": { "type": "string" },
        "shopify_product_id": { "type": "string" },
        "enriched_fields": {
            "type": "object",
            "properties": {
                "seo_title": { "type": "string" },
                "seo_description": { "type": "string" },
                "social_captions": { "type": "object" }
            }
        },
        "rejection_reason": { "type": "string" },
        "created_at": { "type": "string", "format": "date-time" },
        "updated_at": { "type": "string", "format": "date-time" },
        "enriched_at": { "type": "string", "format": "date-time" },
        "published_at": { "type": "string", "format": "date-time" }
      },
      "required": ["source_url", "title", "price"]
    },
    "AdminUser": {
      "title": "AdminUser",
      "type": "object",
      "description": "Represents a user of the system, with roles.",
      "properties": {
          "uid": { "type": "string" },
          "email": { "type": "string", "format": "email" },
          "displayName": { "type": "string" },
          "role": { "type": "string", "enum": ["admin", "editor", "viewer"] },
          "last_login": { "type": "string", "format": "date-time" }
      },
      "required": ["uid", "email", "role"]
    },
    "Schedule": {
        "title": "Schedule",
        "type": "object",
        "description": "A scheduled task, like a social media post.",
        "properties": {
            "product_id": { "type": "string" },
            "channel": { "type": "string", "enum": ["twitter", "facebook"] },
            "content": { "type": "string" },
            "media_url": { "type": "string", "format": "uri" },
            "scheduled_at": { "type": "string", "format": "date-time" },
            "status": { "type": "string", "enum": ["pending", "processing", "posted", "failed"] },
            "posted_at": { "type": "string", "format": "date-time" }
        },
        "required": ["product_id", "channel", "content", "scheduled_at", "status"]
    },
    "AuditLog": {
        "title": "AuditLog",
        "type": "object",
        "description": "Immutable log of critical system actions.",
        "properties": {
            "actor_uid": { "type": "string" },
            "action": { "type": "string" },
            "target_resource": { "type": "string" },
            "timestamp": { "type": "string", "format": "date-time" },
            "details": { "type": "object" }
        },
        "required": ["actor_uid", "action", "target_resource", "timestamp"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "google.com"
    ]
  },
  "firestore": {
      "structure": [
          { "path": "/products/{productId}", "definition": { "schema": { "$ref": "#/entities/Product" } } },
          { "path": "/users/{userId}", "definition": { "schema": { "$ref": "#/entities/AdminUser" } } },
          { "path": "/schedules/{scheduleId}", "definition": { "schema": { "$ref": "#/entities/Schedule" } } },
          { "path": "/audit/{auditId}", "definition": { "schema": { "$ref": "#/entities/AuditLog" } } }
      ]
  }
}
